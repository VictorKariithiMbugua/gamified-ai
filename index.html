<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gamified Remote Storage — Vercel Edition</title>
<style>
body { font-family: monospace; background:#0f172a; color:white; display:flex; flex-direction:column; align-items:center; padding:20px; }
#storage { width:600px; border:2px solid #555; border-radius:10px; padding:10px; min-height:200px; background: rgba(30,41,59,0.9); margin-bottom:10px; }
#chat { width:600px; height:200px; overflow-y:auto; border:2px solid #555; border-radius:10px; padding:10px; background: rgba(30,41,59,0.7); margin-bottom:10px; }
input, button { width:600px; padding:10px; margin:5px 0; border-radius:5px; border:none; }
button { background:#0ea5e9; color:white; cursor:pointer; }
button:hover { background:#0284c7; }
.level { color:#4ade80; font-weight:bold; }
.slot { border:1px solid #4ade80; margin:5px; padding:5px; border-radius:3px; display:inline-block; min-width:80px; text-align:center; }
</style>
</head>
<body>

<h2>Gamified Remote Storage — Vercel Edition</h2>

<div id="storage">Storage Slots: <span id="slots"></span></div>
<div id="chat"></div>

<input type="text" id="input" placeholder="Store or retrieve something...">
<button onclick="interact()">Interact</button>
<div>Level: <span id="level">1</span></div>

<script>
const MORSE = {
  "A": ".-", "B":"-...", "C":"-.-.","D":"-..","E":".","F":"..-.",
  "G":"--.","H":"....","I":"..","J":".---","K":"-.-","L":".-..",
  "M":"--","N":"-.","O":"---","P":".--.","Q":"--.-","R":".-.",
  "S":"...","T":"-","U":"..-","V":"...-","W":".--","X":"-..-",
  "Y":"-.--","Z":"--..","0":"-----","1":".----","2":"..---",
  "3":"...--","4":"....-","5":".....","6":"-....","7":"--...",
  "8":"---..","9":"----."," ":"/"
};

let storage = [];
let level = 1;
const chatBox = document.getElementById("chat");
const slotsEl = document.getElementById("slots");
const levelEl = document.getElementById("level");

function updateStorage() {
  slotsEl.innerHTML = "";
  storage.forEach(item => {
    const div = document.createElement("div");
    div.className = "slot";
    div.textContent = item.name;
    slotsEl.appendChild(div);
  });
}

function toMorse(text) {
  return text.toUpperCase().split("").map(c => MORSE[c] || "").join(" ");
}

async function interact() {
  const input = document.getElementById("input");
  const msg = input.value.trim();
  if(!msg) return;
  input.value = '';

  chatBox.innerHTML += `<div><b>You:</b> ${msg}</div>`;
  chatBox.scrollTop = chatBox.scrollHeight;

  let reply;
  try {
    const res = await fetch("/api/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: msg })
    });
    const data = await res.json();
    const content = data.choices?.[0]?.message?.content || "No reply";
    reply = content + "<br><pre>" + toMorse(content) + "</pre>";
  } catch {
    reply = "Error contacting API.<br><pre>... --- ...</pre>";
  }

  chatBox.innerHTML += `<div><b>AI:</b> ${reply}</div>`;
  chatBox.scrollTop = chatBox.scrollHeight;

  storage.push({ name: msg, summary: reply });
  level++;
  levelEl.textContent = level;
  updateStorage();
}
</script>

</body>
</html>
